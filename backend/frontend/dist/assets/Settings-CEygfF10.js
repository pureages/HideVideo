import{G as A,u as Xe,a as Ye,j as c,s as be,o as Ze,c as d,i as ke,b as e,t as o,d as r,F as C,r as se,f as g,x as pe,h as T,E as D,g as Ue,e as m,w as b,v as k,m as et,D as tt,n as u,y as Ae,H as ae,B as st,C as at}from"./index--Q4BRkWj.js";import{t as j,a as R}from"./actor-CwJ4gNpB.js";import{s as Ce}from"./setting-dMvJKkiB.js";import{_ as nt,A as rt}from"./AppFooter-Deo1k4jp.js";import{T as ot}from"./TopNav-B-jgEhDd.js";const L={getCurrentUser(){return A.get("/users/me")},getUsers(){return A.get("/users")},addUser(p){return A.post("/users",p)},deleteUser(p){return A.delete(`/users/${p}`)},updatePassword(p,x){return A.put("/users/password",{old_password:p,new_password:x})},updateInfo(p){return A.put("/users/info",{username:p})},adminUpdateUserPassword(p,x){return A.put(`/users/${p}/password`,{new_password:x})},adminUpdateUserInfo(p,x){return A.put(`/users/${p}/info`,{username:x})}},lt={class:"settings-page"},it={class:"content"},ct={class:"settings-layout"},dt={class:"settings-sidebar"},ut={class:"sidebar-nav"},vt=["onClick"],gt={key:0,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},pt={key:1,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},mt={key:2,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ht={key:3,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},ft={key:4,width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},yt={class:"settings-main"},_t={key:0,class:"settings-card"},wt={class:"settings-form"},bt={class:"form-group"},kt={class:"form-group"},Ut={value:"purple"},At={value:"light"},Ct={value:"pink"},Dt={value:"cyan"},xt={class:"form-group"},Tt=["title"],Vt={class:"direction-toggle"},St={class:"form-group"},It={class:"checkbox-label"},Pt=["title"],Et={key:1,class:"settings-card"},Nt={class:"info-section"},Ft={class:"info-row"},Bt={class:"label"},Lt={class:"value"},Mt={class:"info-row"},$t={class:"label"},zt={class:"form-section"},Ht={class:"form-group"},Ot={class:"checkbox-label"},qt=["title"],Kt={key:0,class:"form-section"},jt={class:"form-group"},Rt=["placeholder"],Gt=["disabled"],Jt={class:"form-section"},Qt={class:"form-group"},Wt=["placeholder"],Xt={class:"form-group"},Yt=["placeholder"],Zt=["disabled"],es={key:2,class:"settings-card"},ts={class:"form-section"},ss={class:"form-row"},as={class:"form-group",style:{flex:"1"}},ns=["placeholder"],rs=["disabled"],os={class:"tag-section"},ls={class:"drag-hint"},is=["onDragstart","onDragover"],cs=["onKeyup"],ds=["onClick"],us={class:"tag-name"},vs=["onClick"],gs=["onClick"],ps={key:0,class:"empty-text"},ms={key:3,class:"settings-card"},hs={class:"form-section"},fs={class:"form-row"},ys={class:"form-group",style:{flex:"1"}},_s=["placeholder"],ws=["disabled"],bs={class:"tag-section"},ks={class:"drag-hint"},Us=["onDragstart","onDragover"],As=["onKeyup"],Cs=["onClick"],Ds={class:"tag-name"},xs=["onClick"],Ts=["onClick"],Vs={key:0,class:"empty-text"},Ss={key:4,class:"settings-card"},Is=["title"],Ps={class:"form-section"},Es={class:"form-row"},Ns={class:"form-group"},Fs=["placeholder"],Bs={class:"form-group"},Ls=["placeholder"],Ms={class:"form-group"},$s={value:"member"},zs={value:"admin"},Hs=["disabled"],Os={class:"user-section"},qs={class:"user-list"},Ks={class:"user-info"},js={class:"user-name"},Rs={class:"user-date"},Gs=["onClick"],Js={__name:"Settings",setup(p){const x=et(),f=Xe(),{t:s,locale:M}=Ye();function G(n,t){try{let a=M==null?void 0:M.value;(!a||typeof a!="string")&&(a="zh-CN");let i=a==="en"?st:at;const v=n.split(".");let U=i;for(const te of v)if(U&&typeof U=="object")U=U[te];else return n;return typeof U!="string"?n:(t&&Object.keys(t).forEach(te=>{U=U.replace(new RegExp("{{"+te+"}}","g"),t[te])}),U)}catch{return n}}const y=c("basic"),$=c(localStorage.getItem("language")||"zh-CN"),V=c(localStorage.getItem("theme")||"purple");be(y,n=>{f.role!=="admin"&&(n==="tags"||n==="actors"||n==="users")&&(y.value="basic")}),be($,n=>{M.value=n});function De(){localStorage.setItem("theme",V.value);const n=document.getElementById("theme-style");n&&(V.value==="light"?n.href="/assets/theme-light.css":V.value==="pink"?n.href="/assets/theme-pink.css":V.value==="cyan"?n.href="/assets/theme-cyan.css":n.href="/assets/theme-purple.css"),window.dispatchEvent(new Event("theme-change"))}const ne=c(localStorage.getItem("arrowDirection")||"horizontal"),re=c(localStorage.getItem("allowDeleteVideo")==="true"),J=c(!1);function me(n){ne.value=n,localStorage.setItem("arrowDirection",n)}function xe(){localStorage.setItem("allowDeleteVideo",re.value)}async function Te(){try{await Ce.setLoginProtection(J.value)}catch(n){console.error(n)}}async function Ve(){try{const n=await Ce.getLoginProtection();J.value=n.enabled}catch(n){console.error(n)}}const z=c({username:"",role:"member"}),S=c(""),H=c(""),O=c(""),Q=c(!1),W=c(!1),oe=c([]),X=c(!1),h=c({username:"",password:"",role:"member"}),I=c([]),Y=c(!1),q=c(""),le=c(null),P=c(""),_=c(null),ie=c(null),E=c([]),Z=c(!1),K=c(""),ce=c(null),N=c(""),w=c(null),de=c(null),he=c({}),ee=c(""),fe=c("success"),Se=tt(()=>{const n=[{key:"basic",label:s("settings.basic")},{key:"security",label:s("settings.security")}];return f.role==="admin"&&(n.push({key:"tags",label:s("settings.tags")}),n.push({key:"actors",label:s("settings.actors")}),n.push({key:"users",label:s("settings.users")})),n});Ze(async()=>{if(!(await f.checkAuth()).is_login){x.push("/login");return}await ye(),await F(),await B(),await Ve(),f.role==="admin"&&await ue()});async function ye(){try{const n=await L.getCurrentUser();z.value=n,S.value=n.username,f.role=n.role||"member",f.username=n.username}catch{l(s("errors.getUserInfoFailed"),"error")}}async function ue(){try{const n=await L.getUsers();oe.value=n,he.value={},oe.value.forEach(t=>{he.value[t.id]={editing:!1,username:t.username,newPassword:""}})}catch{l(s("errors.getUserListFailed"),"error")}}function Ie(){localStorage.setItem("language",$.value),M.value=$.value,l(s("settings.languageChanged"),"success")}async function Pe(){var n,t;if(!S.value.trim()){l(s("errors.usernameEmpty"),"error");return}Q.value=!0;try{await L.updateInfo(S.value),f.username=S.value,await ye(),l(s("errors.usernameUpdated"),"success")}catch(a){l(((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.error)||s("errors.updateFailed"),"error")}finally{Q.value=!1}}async function Ee(){var n,t;if(!H.value||!O.value){l(s("errors.passwordEmpty"),"error");return}W.value=!0;try{await L.updatePassword(H.value,O.value),H.value="",O.value="",l(s("errors.passwordUpdated"),"success")}catch(a){l(((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.error)||s("errors.updateFailed"),"error")}finally{W.value=!1}}async function F(){try{I.value=await j.getTags()}catch(n){console.error(n)}}async function Ne(){var n,t;if(!q.value.trim()){l(s("errors.tagNameEmpty"),"error");return}Y.value=!0;try{await j.addTag(q.value.trim()),q.value="",await F(),l(s("errors.tagAdded"),"success")}catch(a){l(((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.error)||s("errors.addTagFailed"),"error")}finally{Y.value=!1}}function Fe(n){le.value=n.id,P.value=n.name}function ve(){le.value=null,P.value=""}async function _e(n){var t,a;if(!P.value.trim()){l(s("errors.tagNameCannotEmpty"),"error");return}try{await j.updateTag(n,P.value.trim()),await F(),ve(),l(s("errors.tagUpdated"),"success")}catch(i){l(((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.error)||s("errors.updateTagFailed"),"error")}}async function Be(n){var t,a;if(confirm(s("errors.confirmDeleteTag")))try{await j.deleteTag(n),await F(),l(s("errors.tagDeleted"),"success")}catch(i){l(((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.error)||s("errors.deleteTagFailed"),"error")}}function Le(n,t){_.value=t,n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text/plain",t)}function Me(){_.value=null,ie.value=null}function $e(n,t){if(_.value===null||_.value===t)return;ie.value=t;const a=[...I.value],i=a[_.value];a.splice(_.value,1),a.splice(t,0,i),I.value=a,_.value=t}async function ze(){var t,a;const n=I.value.map(i=>i.id);try{await j.reorderTags(n),await F(),l(s("errors.orderSaved"),"success")}catch(i){l(((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.error)||s("errors.saveOrderFailed"),"error"),await F()}_.value=null,ie.value=null}async function B(){try{E.value=await R.getActors()}catch(n){console.error(n)}}async function He(){var n,t;if(!K.value.trim()){l(s("errors.actorNameEmpty"),"error");return}Z.value=!0;try{await R.addActor(K.value.trim()),K.value="",await B(),l(s("errors.actorAdded"),"success")}catch(a){l(((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.error)||s("errors.addActorFailed"),"error")}finally{Z.value=!1}}function Oe(n){ce.value=n.id,N.value=n.name}function ge(){ce.value=null,N.value=""}async function we(n){var t,a;if(!N.value.trim()){l(s("errors.actorNameCannotEmpty"),"error");return}try{await R.updateActor(n,N.value.trim()),await B(),ge(),l(s("errors.actorUpdated"),"success")}catch(i){l(((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.error)||s("errors.updateActorFailed"),"error")}}async function qe(n){var t,a;if(confirm(s("errors.confirmDeleteActor")))try{await R.deleteActor(n),await B(),l(s("errors.actorDeleted"),"success")}catch(i){l(((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.error)||s("errors.deleteActorFailed"),"error")}}function Ke(n,t){w.value=t,n.dataTransfer.effectAllowed="move",n.dataTransfer.setData("text/plain",t)}function je(){w.value=null,de.value=null}function Re(n,t){if(w.value===null||w.value===t)return;de.value=t;const a=[...E.value],i=a[w.value];a.splice(w.value,1),a.splice(t,0,i),E.value=a,w.value=t}async function Ge(){var t,a;const n=E.value.map(i=>i.id);try{await R.reorderActors(n),await B(),l(s("errors.orderSaved"),"success")}catch(i){l(((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.error)||s("errors.saveOrderFailed"),"error"),await B()}w.value=null,de.value=null}async function Je(){var n,t;if(!h.value.username||!h.value.password){l(s("errors.fillAllFields"),"error");return}X.value=!0;try{await L.addUser(h.value),h.value={username:"",password:"",role:"member"},await ue(),l(s("errors.userAdded"),"success")}catch(a){l(((t=(n=a.response)==null?void 0:n.data)==null?void 0:t.error)||s("errors.addUserFailed"),"error")}finally{X.value=!1}}async function Qe(n){var t,a;if(confirm(G("errors.confirmDeleteUser",{username:n.username})))try{await L.deleteUser(n.id),await ue(),l(s("errors.deleted"),"success")}catch(i){l(((a=(t=i.response)==null?void 0:t.data)==null?void 0:a.error)||s("errors.deleteFailed"),"error")}}function We(n){return n?new Date(n).toLocaleDateString("zh-CN"):""}function l(n,t="success"){ee.value=n,fe.value=t,setTimeout(()=>{ee.value=""},3e3)}return(n,t)=>(u(),d("div",lt,[ke(ot),e("div",it,[e("h1",null,o(r(s)("settings.title")),1),e("div",ct,[e("aside",dt,[e("nav",ut,[(u(!0),d(C,null,se(Se.value,a=>(u(),d("button",{key:a.key,class:D(["nav-item",{active:y.value===a.key}]),onClick:i=>y.value=a.key},[a.key==="basic"?(u(),d("svg",gt,[...t[18]||(t[18]=[e("circle",{cx:"12",cy:"12",r:"3"},null,-1),e("path",{d:"M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"},null,-1)])])):a.key==="security"?(u(),d("svg",pt,[...t[19]||(t[19]=[e("path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"},null,-1)])])):a.key==="users"?(u(),d("svg",mt,[...t[20]||(t[20]=[e("path",{d:"M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"},null,-1),e("circle",{cx:"9",cy:"7",r:"4"},null,-1),e("path",{d:"M23 21v-2a4 4 0 00-3-3.87"},null,-1),e("path",{d:"M16 3.13a4 4 0 010 7.75"},null,-1)])])):a.key==="tags"?(u(),d("svg",ht,[...t[21]||(t[21]=[e("path",{d:"M20.59 13.41l-7.17 7.17a2 2 0 01-2.83 0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"},null,-1),e("line",{x1:"7",y1:"7",x2:"7.01",y2:"7"},null,-1)])])):a.key==="actors"?(u(),d("svg",ft,[...t[22]||(t[22]=[e("path",{d:"M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"},null,-1),e("circle",{cx:"12",cy:"7",r:"4"},null,-1)])])):m("",!0),T(" "+o(a.label),1)],10,vt))),128))])]),e("main",yt,[y.value==="basic"?(u(),d("div",_t,[e("h2",null,o(r(s)("settings.basic")),1),e("div",wt,[e("div",bt,[e("label",null,o(r(s)("settings.systemLanguage")),1),g(e("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>$.value=a),class:"input",onChange:Ie},[...t[23]||(t[23]=[e("option",{value:"zh-CN"},"简体中文",-1),e("option",{value:"en"},"English",-1)])],544),[[pe,$.value]])]),e("div",kt,[e("label",null,o(r(s)("settings.theme")),1),g(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>V.value=a),class:"input",onChange:De},[e("option",Ut,o(r(s)("settings.themePurple")),1),e("option",At,o(r(s)("settings.themeLight")),1),e("option",Ct,o(r(s)("settings.themePink")),1),e("option",Dt,o(r(s)("settings.themeCyan")),1)],544),[[pe,V.value]])]),e("div",xt,[e("label",null,[T(o(r(s)("settings.videoSwitchDirection"))+" ",1),e("span",{class:"help-icon",title:r(s)("settings.videoSwitchDirectionHint")},"?",8,Tt)]),e("div",Vt,[e("button",{type:"button",class:D(["toggle-btn",{active:ne.value==="horizontal"}]),onClick:t[2]||(t[2]=a=>me("horizontal"))},[t[24]||(t[24]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"15 18 9 12 15 6"}),e("polyline",{points:"9 18 15 12 9 6"})],-1)),T(" "+o(r(s)("settings.horizontal")),1)],2),e("button",{type:"button",class:D(["toggle-btn",{active:ne.value==="vertical"}]),onClick:t[3]||(t[3]=a=>me("vertical"))},[t[25]||(t[25]=e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"18 9 12 15 6 9"}),e("polyline",{points:"18 15 12 9 6 15"})],-1)),T(" "+o(r(s)("settings.vertical")),1)],2)])]),e("div",St,[e("label",It,[g(e("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=a=>re.value=a),onChange:xe},null,544),[[Ue,re.value]]),e("span",null,o(r(s)("settings.allowDeleteVideo")),1),e("span",{class:"help-icon",title:r(s)("settings.allowDeleteVideoHint")},"?",8,Pt)])])])])):m("",!0),y.value==="security"?(u(),d("div",Et,[e("h2",null,o(r(s)("settings.security")),1),e("div",Nt,[e("h3",null,o(r(s)("settings.accountInfo")),1),e("div",Ft,[e("span",Bt,o(r(s)("settings.username"))+":",1),e("span",Lt,o(z.value.username),1)]),e("div",Mt,[e("span",$t,o(r(s)("settings.role"))+":",1),e("span",{class:D(["value role-badge",z.value.role])},o(z.value.role==="admin"?r(s)("settings.admin"):r(s)("settings.member")),3)])]),e("div",zt,[e("h3",null,o(r(s)("settings.loginProtection")),1),e("div",Ht,[e("label",Ot,[g(e("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=a=>J.value=a),onChange:Te},null,544),[[Ue,J.value]]),e("span",null,o(r(s)("settings.enableLoginProtection")),1),e("span",{class:"help-icon",title:r(s)("settings.loginProtectionHint")},"?",8,qt)])])]),r(f).role==="admin"?(u(),d("div",Kt,[e("h3",null,o(r(s)("settings.changeUsername")),1),e("form",{onSubmit:b(Pe,["prevent"]),class:"settings-form"},[e("div",jt,[e("label",null,o(r(s)("settings.newUsername")),1),g(e("input",{"onUpdate:modelValue":t[6]||(t[6]=a=>S.value=a),type:"text",class:"input",placeholder:r(s)("settings.enterNewUsername"),required:""},null,8,Rt),[[k,S.value]])]),e("button",{type:"submit",class:"btn btn-primary",disabled:Q.value},o(Q.value?r(s)("settings.updatingUsername"):r(s)("settings.updateUsername")),9,Gt)],32)])):m("",!0),e("div",Jt,[e("h3",null,o(r(s)("settings.changePassword")),1),e("form",{onSubmit:b(Ee,["prevent"]),class:"settings-form"},[e("div",Qt,[e("label",null,o(r(s)("settings.oldPassword")),1),g(e("input",{"onUpdate:modelValue":t[7]||(t[7]=a=>H.value=a),type:"password",class:"input",placeholder:r(s)("settings.enterOldPassword"),required:""},null,8,Wt),[[k,H.value]])]),e("div",Xt,[e("label",null,o(r(s)("settings.newPassword")),1),g(e("input",{"onUpdate:modelValue":t[8]||(t[8]=a=>O.value=a),type:"password",class:"input",placeholder:r(s)("settings.enterNewPassword"),required:""},null,8,Yt),[[k,O.value]])]),e("button",{type:"submit",class:"btn btn-primary",disabled:W.value},o(W.value?r(s)("settings.updatingPassword"):r(s)("settings.updatePassword")),9,Zt)],32)])])):m("",!0),y.value==="tags"?(u(),d("div",es,[e("h2",null,o(r(s)("settings.tags")),1),e("div",ts,[e("h3",null,o(r(s)("settings.addTag")),1),e("form",{onSubmit:b(Ne,["prevent"]),class:"settings-form add-tag-form"},[e("div",ss,[e("div",as,[g(e("input",{"onUpdate:modelValue":t[9]||(t[9]=a=>q.value=a),type:"text",class:"input",placeholder:r(s)("settings.enterTagName"),required:""},null,8,ns),[[k,q.value]])]),e("button",{type:"submit",class:"btn btn-primary",disabled:Y.value},o(Y.value?r(s)("settings.addingTag"):r(s)("settings.addTagBtn")),9,rs)])],32)]),e("div",os,[e("h3",null,[T(o(r(s)("settings.tagList"))+" ",1),e("span",ls,o(r(s)("settings.dragToSort")),1)]),e("div",{class:"tag-list",onDragover:t[11]||(t[11]=b(()=>{},["prevent"])),onDrop:ze},[(u(!0),d(C,null,se(I.value,(a,i)=>(u(),d("div",{key:a.id,class:D(["tag-item",{dragging:_.value===i}]),draggable:"true",onDragstart:v=>Le(v,i),onDragend:Me,onDragover:b(v=>$e(v,i),["prevent"])},[t[26]||(t[26]=Ae('<span class="drag-handle" data-v-28fc96f9><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" data-v-28fc96f9><circle cx="9" cy="6" r="2" data-v-28fc96f9></circle><circle cx="15" cy="6" r="2" data-v-28fc96f9></circle><circle cx="9" cy="12" r="2" data-v-28fc96f9></circle><circle cx="15" cy="12" r="2" data-v-28fc96f9></circle><circle cx="9" cy="18" r="2" data-v-28fc96f9></circle><circle cx="15" cy="18" r="2" data-v-28fc96f9></circle></svg></span>',1)),le.value===a.id?(u(),d(C,{key:0},[g(e("input",{"onUpdate:modelValue":t[10]||(t[10]=v=>P.value=v),type:"text",class:"input",onKeyup:[ae(v=>_e(a.id),["enter"]),ae(ve,["escape"])]},null,40,cs),[[k,P.value]]),e("button",{class:"btn btn-primary btn-sm",onClick:v=>_e(a.id)},o(r(s)("settings.save")),9,ds),e("button",{class:"btn btn-secondary btn-sm",onClick:ve},o(r(s)("common.cancel")),1)],64)):(u(),d(C,{key:1},[e("span",us,o(a.name),1),e("button",{class:"btn btn-secondary btn-sm",onClick:v=>Fe(a)},o(r(s)("common.edit")),9,vs),e("button",{class:"btn btn-danger btn-sm",onClick:v=>Be(a.id)},o(r(s)("common.delete")),9,gs)],64))],42,is))),128)),I.value.length===0?(u(),d("div",ps,o(r(s)("settings.noTags")),1)):m("",!0)],32)])])):m("",!0),y.value==="actors"?(u(),d("div",ms,[e("h2",null,o(r(s)("settings.actors")),1),e("div",hs,[e("h3",null,o(r(s)("settings.addActor")),1),e("form",{onSubmit:b(He,["prevent"]),class:"settings-form add-tag-form"},[e("div",fs,[e("div",ys,[g(e("input",{"onUpdate:modelValue":t[12]||(t[12]=a=>K.value=a),type:"text",class:"input",placeholder:r(s)("settings.enterActorName"),required:""},null,8,_s),[[k,K.value]])]),e("button",{type:"submit",class:"btn btn-primary",disabled:Z.value},o(Z.value?r(s)("settings.addingActor"):r(s)("settings.addActorBtn")),9,ws)])],32)]),e("div",bs,[e("h3",null,[T(o(r(s)("settings.actorList"))+" ",1),e("span",ks,o(r(s)("settings.dragToSort")),1)]),e("div",{class:"tag-list",onDragover:t[14]||(t[14]=b(()=>{},["prevent"])),onDrop:Ge},[(u(!0),d(C,null,se(E.value,(a,i)=>(u(),d("div",{key:a.id,class:D(["tag-item",{dragging:w.value===i}]),draggable:"true",onDragstart:v=>Ke(v,i),onDragend:je,onDragover:b(v=>Re(v,i),["prevent"])},[t[27]||(t[27]=Ae('<span class="drag-handle" data-v-28fc96f9><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" data-v-28fc96f9><circle cx="9" cy="6" r="2" data-v-28fc96f9></circle><circle cx="15" cy="6" r="2" data-v-28fc96f9></circle><circle cx="9" cy="12" r="2" data-v-28fc96f9></circle><circle cx="15" cy="12" r="2" data-v-28fc96f9></circle><circle cx="9" cy="18" r="2" data-v-28fc96f9></circle><circle cx="15" cy="18" r="2" data-v-28fc96f9></circle></svg></span>',1)),ce.value===a.id?(u(),d(C,{key:0},[g(e("input",{"onUpdate:modelValue":t[13]||(t[13]=v=>N.value=v),type:"text",class:"input",onKeyup:[ae(v=>we(a.id),["enter"]),ae(ge,["escape"])]},null,40,As),[[k,N.value]]),e("button",{class:"btn btn-primary btn-sm",onClick:v=>we(a.id)},o(r(s)("settings.save")),9,Cs),e("button",{class:"btn btn-secondary btn-sm",onClick:ge},o(r(s)("common.cancel")),1)],64)):(u(),d(C,{key:1},[e("span",Ds,o(a.name),1),e("button",{class:"btn btn-secondary btn-sm",onClick:v=>Oe(a)},o(r(s)("common.edit")),9,xs),e("button",{class:"btn btn-danger btn-sm",onClick:v=>qe(a.id)},o(r(s)("common.delete")),9,Ts)],64))],42,Us))),128)),E.value.length===0?(u(),d("div",Vs,o(r(s)("settings.noActors")),1)):m("",!0)],32)])])):m("",!0),y.value==="users"&&r(f).role==="admin"?(u(),d("div",Ss,[e("h2",null,[T(o(r(s)("settings.users"))+" ",1),e("span",{class:"help-icon",title:r(s)("settings.userManagementHint")},"?",8,Is)]),e("div",Ps,[e("h3",null,o(r(s)("settings.addUser")),1),e("form",{onSubmit:b(Je,["prevent"]),class:"settings-form add-user-form"},[e("div",Es,[e("div",Ns,[e("label",null,o(r(s)("settings.username")),1),g(e("input",{"onUpdate:modelValue":t[15]||(t[15]=a=>h.value.username=a),type:"text",class:"input",placeholder:r(s)("settings.username"),required:""},null,8,Fs),[[k,h.value.username]])]),e("div",Bs,[e("label",null,o(r(s)("settings.password")),1),g(e("input",{"onUpdate:modelValue":t[16]||(t[16]=a=>h.value.password=a),type:"text",class:"input",placeholder:r(s)("settings.password"),required:""},null,8,Ls),[[k,h.value.password]])]),e("div",Ms,[e("label",null,o(r(s)("settings.roleSelect")),1),g(e("select",{"onUpdate:modelValue":t[17]||(t[17]=a=>h.value.role=a),class:"input"},[e("option",$s,o(r(s)("settings.member")),1),e("option",zs,o(r(s)("settings.admin")),1)],512),[[pe,h.value.role]])]),e("button",{type:"submit",class:"btn btn-primary",disabled:X.value},o(X.value?r(s)("settings.addingUser"):r(s)("settings.addUserBtn")),9,Hs)])],32)]),e("div",Os,[e("h3",null,o(r(s)("settings.userList")),1),e("div",qs,[(u(!0),d(C,null,se(oe.value,a=>(u(),d("div",{key:a.id,class:"user-item"},[e("div",Ks,[e("span",js,o(a.username),1),e("span",{class:D(["user-role role-badge",a.role])},o(a.role==="admin"?G("settings.admin"):G("settings.member")),3),e("span",Rs,o(G("settings.createdAt",{date:We(a.created_at)})),1)]),a.id!==z.value.id?(u(),d("button",{key:0,class:"btn btn-danger btn-sm",onClick:i=>Qe(a)},o(r(s)("common.delete")),9,Gs)):m("",!0)]))),128))])])])):m("",!0)])])]),ee.value?(u(),d("div",{key:0,class:D(["result-toast",fe.value])},o(ee.value),3)):m("",!0),ke(rt)]))}},ea=nt(Js,[["__scopeId","data-v-28fc96f9"]]);export{ea as default};
