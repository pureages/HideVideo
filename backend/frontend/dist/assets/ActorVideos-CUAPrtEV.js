import{u as Z,j as i,s as V,o as tt,c as s,i as F,b as e,h as y,t as u,f as P,x as $,y as N,e as v,p as et,F as I,r as z,z as ot,m as at,A as lt,D as st,n as l,E as nt}from"./index--Q4BRkWj.js";import{a as O}from"./actor-CwJ4gNpB.js";import{V as it}from"./VideoPlayer-QGm-AeJc.js";import{_ as rt,A as ut}from"./AppFooter-Deo1k4jp.js";import{T as dt}from"./TopNav-B-jgEhDd.js";const ct={class:"actor-videos-page"},vt={class:"main-container"},pt={class:"content"},gt={class:"actor-header"},ht={class:"actor-info"},yt={class:"video-count"},ft={class:"toolbar"},xt={class:"toolbar-right"},bt={class:"display-settings"},mt={class:"sort-options"},kt={key:0,class:"search-result-header"},_t={class:"search-result-info"},wt=["onClick"],Ct={class:"video-cover"},St=["src","alt"],Vt={key:1,class:"cover-placeholder"},It={class:"video-duration"},Bt={class:"video-info"},At=["title"],Pt={class:"video-meta"},$t={key:0,class:"rating"},Nt={key:1,class:"play-count"},zt={key:0,class:"video-tags"},Dt={key:1,class:"empty-state"},Mt={key:2,class:"loading"},Ft={key:3,class:"pagination-wrapper"},Ot={class:"pagination"},Tt=["disabled"],Ut={key:0,class:"page-ellipsis"},Et=["onClick"],Lt=["disabled"],Rt={__name:"ActorVideos",setup(jt){const m=at(),T=lt(),D=Z(),f=i(!0),k=i(null),M=i(""),d=i([]),_=i(0),r=i(1),w=i(parseInt(localStorage.getItem("pageSize"))||24),x=i(0),c=i(""),C=i(parseInt(localStorage.getItem("gridCols"))||4),b=i(localStorage.getItem("sortOption")||"created_at-desc"),S=i(!1),g=i(null),h=i(0);V(C,o=>{localStorage.setItem("gridCols",o)}),V(w,o=>{localStorage.setItem("pageSize",o)}),V(b,o=>{localStorage.setItem("sortOption",o)}),V(c,()=>{r.value=1,p()}),tt(async()=>{if(await D.checkAuth(),!D.isLogin){m.push("/login");return}if(k.value=parseInt(T.params.id),!k.value){m.push("/");return}await U(),await p(),f.value=!1});async function U(){try{const t=(await O.getActors()).find(a=>a.id===k.value);t&&(M.value=t.name)}catch(o){console.error(o)}}async function p(){f.value=!0;try{const[o,t]=b.value.split("-"),a={page:r.value,page_size:w.value,sort_by:o,order:t,keyword:c.value};b.value==="random"&&(a.sort_by="random");const n=await O.getActorVideos(k.value,a);d.value=n.list||[],_.value=n.total||0,x.value=n.total_pages||0}catch(o){console.error(o),d.value=[],_.value=0,x.value=0}finally{f.value=!1}}function E(){r.value=1,p()}function L(){c.value=""}function R(){r.value=1,p()}function j(){r.value=1,p()}function B(o){r.value=o,p(),window.scrollTo({top:0,behavior:"smooth"})}const K=st(()=>{const o=x.value,t=r.value,a=[];if(o<=7)for(let n=1;n<=o;n++)a.push(n);else t<=3?a.push(1,2,3,4,"...",o):t>=o-2?a.push(1,"...",o-3,o-2,o-1,o):a.push(1,"...",t-1,t,t+1,"...",o);return a});function q(o){if(!o)return"00:00";const t=Math.floor(o/3600),a=Math.floor(o%3600/60),n=Math.floor(o%60);return t>0?`${t}:${a.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`:`${a}:${n.toString().padStart(2,"0")}`}function A(o){if(!o)return"";const t=o.lastIndexOf(".");return t>0?o.substring(0,t):o}function G(){m.back()}function H(o){g.value=o,h.value=d.value.findIndex(t=>t.id===o.id),S.value=!0}function J(){const o=h.value-1;o>=0&&(h.value=o,g.value=d.value[o])}function Q(o){let t;o!=null?t=o:t=h.value+1,t>=0&&t<d.value.length&&(h.value=t,g.value=d.value[t])}function W(){S.value=!1,g.value=null}function X(){S.value=!1,g.value=null,p()}function Y(o){m.push({path:`/actor/${o.id}`})}return(o,t)=>(l(),s("div",ct,[F(dt,{"show-search":!0,modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=a=>c.value=a),onSearch:E},null,8,["modelValue"]),e("div",vt,[e("main",pt,[e("div",gt,[e("button",{class:"back-btn",onClick:G},[...t[6]||(t[6]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"15 18 9 12 15 6"})],-1),y(" 返回 ",-1)])]),e("div",ht,[e("h1",null,u(M.value),1),e("span",yt,"共 "+u(_.value)+" 个视频",1)])]),e("div",ft,[t[12]||(t[12]=e("div",{class:"toolbar-left"},null,-1)),e("div",xt,[e("div",bt,[e("label",null,[t[8]||(t[8]=y(" 每页 ",-1)),P(e("select",{"onUpdate:modelValue":t[1]||(t[1]=a=>w.value=a),onChange:j,class:"select"},[...t[7]||(t[7]=[e("option",{value:12},"12",-1),e("option",{value:24},"24",-1),e("option",{value:48},"48",-1)])],544),[[$,w.value]])]),e("label",null,[t[10]||(t[10]=y(" 网格 ",-1)),P(e("select",{"onUpdate:modelValue":t[2]||(t[2]=a=>C.value=a),class:"select"},[...t[9]||(t[9]=[e("option",{value:3},"3x4",-1),e("option",{value:4},"4x3",-1),e("option",{value:5},"5x3",-1),e("option",{value:6},"6x3",-1)])],512),[[$,C.value]])])]),e("div",mt,[P(e("select",{"onUpdate:modelValue":t[3]||(t[3]=a=>b.value=a),onChange:R,class:"select"},[...t[11]||(t[11]=[N('<option value="created_at-desc" data-v-5472b1c7>创建时间 ↓</option><option value="created_at-asc" data-v-5472b1c7>创建时间 ↑</option><option value="play_count-desc" data-v-5472b1c7>播放次数 ↓</option><option value="play_count-asc" data-v-5472b1c7>播放次数 ↑</option><option value="rating-desc" data-v-5472b1c7>评分 ↓</option><option value="rating-asc" data-v-5472b1c7>评分 ↑</option><option value="random" data-v-5472b1c7>随机排序</option>',7)])],544),[[$,b.value]])])])]),c.value?(l(),s("div",kt,[e("div",_t,' 搜索"'+u(c.value)+'"的结果，共 '+u(_.value)+" 个视频 ",1),e("button",{class:"btn btn-secondary",onClick:L},[...t[13]||(t[13]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("path",{d:"M18 6L6 18M6 6l12 12"})],-1),y(" 取消搜索 ",-1)])])])):v("",!0),e("div",{class:"video-grid",style:et({"--cols":C.value})},[(l(!0),s(I,null,z(d.value,a=>(l(),s("div",{key:a.id,class:"video-card",onClick:n=>H(a)},[e("div",Ct,[a.cover_path?(l(),s("img",{key:0,src:a.cover_path,alt:A(a.filename)},null,8,St)):(l(),s("div",Vt,[...t[14]||(t[14]=[N('<svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" data-v-5472b1c7><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18" data-v-5472b1c7></rect><line x1="7" y1="2" x2="7" y2="22" data-v-5472b1c7></line><line x1="17" y1="2" x2="17" y2="22" data-v-5472b1c7></line><line x1="2" y1="12" x2="22" y2="12" data-v-5472b1c7></line><line x1="2" y1="7" x2="7" y2="7" data-v-5472b1c7></line><line x1="2" y1="17" x2="7" y2="17" data-v-5472b1c7></line><line x1="17" y1="17" x2="22" y2="17" data-v-5472b1c7></line><line x1="17" y1="7" x2="22" y2="7" data-v-5472b1c7></line></svg>',1)])])),t[15]||(t[15]=e("div",{class:"video-overlay"},[e("div",{class:"play-icon"},[e("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"currentColor"},[e("polygon",{points:"5 3 19 12 5 21 5 3"})])])],-1)),e("div",It,u(q(a.duration)),1)]),e("div",Bt,[e("h4",{class:"video-title",title:A(a.filename)},u(A(a.filename)),9,At),e("div",Pt,[a.rating>0?(l(),s("span",$t,[t[16]||(t[16]=e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor"},[e("polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"})],-1)),y(" "+u(a.rating.toFixed(1)),1)])):v("",!0),a.play_count>0?(l(),s("span",Nt,[t[17]||(t[17]=e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polygon",{points:"5 3 19 12 5 21 5 3"})],-1)),y(" "+u(a.play_count),1)])):v("",!0)]),a.tags&&a.tags.length>0?(l(),s("div",zt,[(l(!0),s(I,null,z(a.tags.slice(0,3),n=>(l(),s("span",{key:n.id,class:"tag"},u(n.name),1))),128))])):v("",!0)])],8,wt))),128))],4),d.value.length===0&&!f.value?(l(),s("div",Dt,[t[18]||(t[18]=N('<svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" data-v-5472b1c7><rect x="2" y="2" width="20" height="20" rx="2.18" ry="2.18" data-v-5472b1c7></rect><line x1="7" y1="2" x2="7" y2="22" data-v-5472b1c7></line><line x1="17" y1="2" x2="17" y2="22" data-v-5472b1c7></line><line x1="2" y1="12" x2="22" y2="12" data-v-5472b1c7></line><line x1="2" y1="7" x2="7" y2="7" data-v-5472b1c7></line><line x1="2" y1="17" x2="7" y2="17" data-v-5472b1c7></line><line x1="17" y1="17" x2="22" y2="17" data-v-5472b1c7></line><line x1="17" y1="7" x2="22" y2="7" data-v-5472b1c7></line></svg>',1)),e("p",null,u(c.value?"没有找到匹配的视频":"该演员暂无视频"),1)])):v("",!0),f.value?(l(),s("div",Mt,[...t[19]||(t[19]=[e("div",{class:"spinner"},null,-1)])])):v("",!0),x.value>1?(l(),s("div",Ft,[e("div",Ot,[e("button",{class:"pagination-btn",disabled:r.value<=1,onClick:t[4]||(t[4]=a=>B(r.value-1))},[...t[20]||(t[20]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"15 18 9 12 15 6"})],-1)])],8,Tt),(l(!0),s(I,null,z(K.value,a=>(l(),s(I,{key:a},[a==="..."?(l(),s("span",Ut,"...")):(l(),s("button",{key:1,class:nt(["pagination-btn",{active:a===r.value}]),onClick:n=>B(a)},u(a),11,Et))],64))),128)),e("button",{class:"pagination-btn",disabled:r.value>=x.value,onClick:t[5]||(t[5]=a=>B(r.value+1))},[...t[21]||(t[21]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"9 18 15 12 9 6"})],-1)])],8,Lt)])])):v("",!0)])]),S.value?(l(),ot(it,{key:0,video:g.value,"video-list":d.value,"current-index":h.value,onClose:W,onPrevVideo:J,onNextVideo:Q,onDeleted:X,onClickActor:Y},null,8,["video","video-list","current-index"])):v("",!0),F(ut)]))}},Qt=rt(Rt,[["__scopeId","data-v-5472b1c7"]]);export{Qt as default};
